<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="lib/connect-rtc-1.1.26.min.js"></script>
    <script src="/frontend-config.js" type="text/javascript"></script>
    <title>DeepL V2V</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <header>
        <h1>DeepL V2V</h1>
        <button id="logoutButton" class="hidden">Logout</button>
      </header>

      <main>
        <div id="leftColumn">
          <section id="ccpSection">
            <h2>Contact Control Panel</h2>
            <div id="ccpContainer"></div>
          </section>
          <section id="audioControls">
            <h2>Audio Controls</h2>
            <div class="control-group">
              <h3>Select Microphone and Speaker</h3>
              <div class="input-group">
                <label for="speakerSelect">Speaker:</label>
                <select id="speakerSelect">
                  <option value="">-- Select Speaker --</option>
                </select>
                <button id="testAudioButton">Test</button>
                <button id="speakerSaveButton">Save</button>
              </div>
              <div class="input-group">
                <label for="micSelect">Microphone:</label>
                <select id="micSelect">
                  <option value="">-- Select Microphone --</option>
                </select>
                <button id="testMicButton">Test</button> <button id="micSaveButton">Save</button>
              </div>
              <div id="volumeBarContainer" class="volume-bar-container">
                <div id="volumeBar" class="volume-bar"></div>
              </div>
              <div class="checkbox-group">
                <input
                  type="checkbox"
                  id="echoCancellationCheckbox"
                  name="echoCancellationCheckbox"
                  title="Browser's built-in echo cancellation. Disable when using high-quality headphones with hardware based echo cancellation."
                  checked
                />
                <label
                  for="echoCancellationCheckbox"
                  title="Browser's built-in echo cancellation. Disable when using high-quality headphones with hardware based echo cancellation."
                  >Echo Cancellation</label
                >
              </div>
              <div class="checkbox-group">
                <input
                  type="checkbox"
                  id="noiseSuppressionCheckbox"
                  name="noiseSuppressionCheckbox"
                  title="Browser's built-in noise suppression. Disable when using high-quality headphones with hardware based noise suppression."
                  checked
                />
                <label
                  for="noiseSuppressionCheckbox"
                  title="Browser's built-in noise suppression. Disable when using high-quality headphones with hardware based noise suppression."
                  >Noise Suppression</label
                >
              </div>
              <div class="checkbox-group">
                <input
                  type="checkbox"
                  id="autoGainControlCheckbox"
                  name="autoGainControlCheckbox"
                  title="Browser's built-in auto gain control for microphone input. Automatically adjusts microphone volume, disable to prevent picking up nearby voices."
                />
                <label
                  for="autoGainControlCheckbox"
                  title="Browser's built-in auto gain control for microphone input. Automatically adjusts microphone volume, disable to prevent picking up nearby voices."
                  >Auto Gain Control</label
                >
              </div>
            </div>
            <div class="control-group">
              <h3>Swap Audio Source</h3>
              <button id="btnStreamFile">Stream File</button>
              <button id="btnStreamMic">Stream Mic</button>
              <button id="btnRemoveAudioStream">Remove Stream</button>
            </div>
          </section>
          <section id="audioPlayback">
            <h2>Audio Playback</h2>
            <div class="audio-group">
              <label for="remote-audio">From Customer:</label>
              <audio id="remote-audio" controls autoplay></audio>
            </div>
            <div class="audio-group">
              <label for="toCustomerAudioElement">To Customer:</label>
              <audio id="toCustomerAudioElement" controls autoplay muted></audio>
            </div>
            <div class="audio-group">
              <label for="toAgentAudioElement">To Agent:</label>
              <audio id="toAgentAudioElement" controls autoplay></audio>
            </div>
          </section>
        </div>
        <div id="rightColumn">
          <section id="transcribeTranslate">
            <div id="divCustomerControls" class="participant-controls">
              <h2>Customer Controls</h2>
              <div class="control-group-transcribe">
                <h3>Audio</h3>
                <div class="checkbox-group">
                  <input type="checkbox" id="customerStreamMicCheckbox" name="customerStreamMicCheckbox" unchecked />
                  <label for="customerStreamMicCheckbox">Stream Customer Mic to Agent</label>
                </div>
                <div class="checkbox-group">
                  <input type="checkbox" id="customerStreamTranslationCheckbox" name="customerStreamTranslationCheckbox" unchecked />
                  <label for="customerStreamTranslationCheckbox">Stream Customer Translation to Customer</label>
                </div>
                <div class="checkbox-group">
                  <input type="checkbox" id="customerAudioFeedbackEnabledCheckbox" name="customerAudioFeedbackEnabledCheckbox" unchecked />
                  <label for="customerAudioFeedbackEnabledCheckbox">Enable Customer Audio Feedback</label>
                </div>
              </div>
              <div class="control-group-translate">
                <h3>Languages</h3>
                <div class="input-group">
                  <label for="customerTranslateFromLanguageSelect">Select Source Language:</label>
                  <select id="customerTranslateFromLanguageSelect">
                    <option value="">-- Select Language --</option>
                  </select>
                  <button id="customerTranslateFromLanguageSaveButton">Save</button>
                </div>
                <div class="input-group">
                  <label for="customerTranslateToLanguageSelect">Select Target Language:</label>
                  <select id="customerTranslateToLanguageSelect">
                    <option value="">-- Select Language --</option>
                  </select>
                  <button id="customerTranslateToLanguageSaveButton">Save</button>
                </div>
                <div class="input-group" hidden>
                  <label for="customerVoiceIdSelect">Select Voice:</label>
                  <select id="customerVoiceIdSelect">
                    <option value="">-- Select Voice --</option>
                  </select>
                  <button id="customerVoiceIdSaveButton">Save</button>
                </div>
                <div class="output-group">
                  <label for="customerTranscriptionTextOutputDiv">Customer Transcription:</label>
                  <div id="customerTranscriptionTextOutputDiv" class="output-text"></div>
                </div>
                <div class="output-group">
                  <label for="customerTranslatedTextOutputDiv">Customer Translation:</label>
                  <div id="customerTranslatedTextOutputDiv" class="output-text"></div>
                </div>

              </div>
              <div class="control-group-latency">
                <h3>Latency</h3>
                  <div id="agent-latency-transcription" style="margin-top: 8px;">
                    Transcription: <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
                  <div id="agent-latency-translation" style="margin-top: 8px;">
                    Translation: <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
                  <div id="agent-latency-audioSynthesis" style="margin-top: 8px;">
                    Audio Synthesis (target -> synth): <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
              </div>

            </div>

            <div id="divAgentControls" class="participant-controls">
              <h2>Agent Controls</h2>
              <div class="control-group-transcribe">
                <h3>Audio</h3>
                <div class="checkbox-group">
                  <input type="checkbox" id="agentStreamMicCheckbox" name="agentStreamMicCheckbox" unchecked />
                  <label for="agentStreamMicCheckbox">Stream Agent Mic to Customer</label>
                </div>
                <div class="checkbox-group">
                  <input type="checkbox" id="agentStreamTranslationCheckbox" name="StreamTranslationCheckbox" unchecked />
                  <label for="agentStreamTranslationCheckbox">Stream Agent Translation to Agent</label>
                </div>
                <div class="checkbox-group">
                  <input type="checkbox" id="agentAudioFeedbackEnabledCheckbox" name="agentAudioFeedbackEnabledCheckbox" unchecked />
                  <label for="agentAudioFeedbackEnabledCheckbox">Enable Agent Audio Feedback</label>
                </div>
                <div class="button-group">
                  <!-- <button id="agentStartTranscriptionButton" disabled>Start Transcription</button>
                  <button id="agentStopTranscriptionButton" disabled>Stop Transcription</button> -->
                  <button id="agentMuteTranscriptionButton">Mute</button>
                </div>
                <div class="volume-group">
                  <label for="agentStreamMicVolume">Microphone Volume:</label>
                  <input type="range" id="agentStreamMicVolume" min="0" max="1" step="0.05" value="0.1" />
                </div>
              </div>
              <div class="control-group-translate">
                <h3>Languages</h3>
                <div class="input-group">
                  <label for="agentTranslateFromLanguageSelect">Select Source Language:</label>
                  <select id="agentTranslateFromLanguageSelect">
                    <option value="">-- Select Language --</option>
                  </select>
                  <button id="agentTranslateFromLanguageSaveButton">Save</button>
                </div>
                <div class="input-group">
                  <label for="agentTranslateToLanguageSelect">Select Target Language:</label>
                  <select id="agentTranslateToLanguageSelect">
                    <option value="">-- Select Language --</option>
                  </select>
                  <button id="agentTranslateToLanguageSaveButton">Save</button>
                </div>
                <div class="input-group" hidden>
                  <label for="agentVoiceIdSelect">Select Voice:</label>
                  <select id="agentVoiceIdSelect">
                    <option value="">-- Select Voice --</option>
                  </select>
                  <button id="agentVoiceIdSaveButton">Save</button>
                </div>
                <div class="output-group">
                  <label for="agentTranscriptionTextOutputDiv">Agent Transcription:</label>
                  <div id="agentTranscriptionTextOutputDiv" class="output-text"></div>
                </div>
                <div class="output-group">
                  <label for="agentTranslatedTextOutputDiv">Agent Translation:</label>
                  <div id="agentTranslatedTextOutputDiv" class="output-text"></div>
                </div>
              </div>
              <div class="control-group-latency">
                <h3>Latency</h3>
                  <div id="customer-latency-transcription" style="margin-top: 8px;">
                    Transcription: <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
                  <div id="customer-latency-translation" style="margin-top: 8px;">
                    Translation: <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
                  <div id="customer-latency-audioSynthesis" style="margin-top: 8px;">
                    Audio Synthesis (target -> synth): <span class="latency-value">-- ms</span>
                    <div class="latency-stats">Avg: -- | Min: -- | Max: -- | P95: --</div>
                  </div>
              </div>
            </div>

            <div id="divTranscription" class="participant-controls">
              <h2>Conversation</h2>
              <div class="control-group-transcription">
                <div id="divTranscriptContainer" class="transcript-container">
                  <div class="transcript-spacer"></div>
                  <!-- Transcript messages will be added here dynamically -->
                </div>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>
    <script type="module" src="/main.js"></script>
  </body>
</html>
